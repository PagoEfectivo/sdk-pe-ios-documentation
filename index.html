<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="lang:clipboard.copy" content="Copy to clipboard"><meta name="lang:clipboard.copied" content="Copied to clipboard"><meta name="lang:search.language" content="en"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="No matching documents"><meta name="lang:search.result.one" content="1 matching document"><meta name="lang:search.result.other" content="# matching documents"><meta name="lang:search.tokenizer" content="[\s\-]+"><link rel="shortcut icon" href="assets/images/favicon.png"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.3.1"><title>PagoEfectivoSDK iOS</title><link rel="stylesheet" href="assets/stylesheets/application.4031d38b.css"><script src="assets/javascripts/modernizr.74668098.js"></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono&display=swap"><style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="assets/fonts/material-icons.css"></head><body dir="ltr"><svg class="md-svg"><defs></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label><a href="#pagoefectivo-sdk-para-ios" tabindex="1" class="md-skip">Skip to content </a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="." title="PagoEfectivoSDK iOS" class="md-header-nav__button md-logo"><i class="md-icon"></i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">PagoEfectivoSDK iOS</span><span class="md-header-nav__topic">Home</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">&#xE5CD;</button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">Type to start searching</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div></div></nav></header><div class="md-container"><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="." title="PagoEfectivoSDK iOS" class="md-nav__button md-logo"><i class="md-icon"></i></a>PagoEfectivoSDK iOS</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"><label class="md-nav__link md-nav__link--active" for="__toc">Home</label><a href="." title="Home" class="md-nav__link md-nav__link--active">Home</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#pagoefectivo-sdk-para-ios" title="PagoEfectivo SDK para iOS" class="md-nav__link">PagoEfectivo SDK para iOS</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#overview" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="#pre-requisitos" title="Pre requisitos" class="md-nav__link">Pre requisitos</a></li><li class="md-nav__item"><a href="#instalacion" title="Instalación" class="md-nav__link">Instalación</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#via-cocoapods" title="Vía CocoaPods" class="md-nav__link">Vía CocoaPods</a></li><li class="md-nav__item"><a href="#via-manual" title="Vía manual" class="md-nav__link">Vía manual</a></li></ul></nav></li><li class="md-nav__item"><a href="#configuracion" title="Configuración" class="md-nav__link">Configuración</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#inicializacion" title="Inicialización" class="md-nav__link">Inicialización</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_1" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_1" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#habilitar-el-entorno-de-desarrollo" title="Habilitar el entorno de desarrollo" class="md-nav__link">Habilitar el entorno de desarrollo</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_2" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_2" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#funcionalidades-del-sdk" title="Funcionalidades del SDK" class="md-nav__link">Funcionalidades del SDK</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#generacion-de-cip" title="Generación de CIP" class="md-nav__link">Generación de CIP</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_3" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_3" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#tratar-la-respuesta-del-servicio" title="Tratar la respuesta del servicio" class="md-nav__link">Tratar la respuesta del servicio</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#swift_4" title="Swift" class="md-nav__link">Swift</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#obtencion-de-datos" title="Obtención de datos" class="md-nav__link">Obtención de datos</a></li><li class="md-nav__item"><a href="#abrir-pasarella-en-una-webview" title="Abrir pasarella en una WebView" class="md-nav__link">Abrir pasarella en una WebView</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#consultar-cips" title="Consultar CIP(s)" class="md-nav__link">Consultar CIP(s)</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_4" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_5" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#feedback" title="Feedback" class="md-nav__link">Feedback</a></li></ul></nav></li></ul></nav></li></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">Table of contents</label><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href="#pagoefectivo-sdk-para-ios" title="PagoEfectivo SDK para iOS" class="md-nav__link">PagoEfectivo SDK para iOS</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#overview" title="Overview" class="md-nav__link">Overview</a></li><li class="md-nav__item"><a href="#pre-requisitos" title="Pre requisitos" class="md-nav__link">Pre requisitos</a></li><li class="md-nav__item"><a href="#instalacion" title="Instalación" class="md-nav__link">Instalación</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#via-cocoapods" title="Vía CocoaPods" class="md-nav__link">Vía CocoaPods</a></li><li class="md-nav__item"><a href="#via-manual" title="Vía manual" class="md-nav__link">Vía manual</a></li></ul></nav></li><li class="md-nav__item"><a href="#configuracion" title="Configuración" class="md-nav__link">Configuración</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#inicializacion" title="Inicialización" class="md-nav__link">Inicialización</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_1" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_1" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#habilitar-el-entorno-de-desarrollo" title="Habilitar el entorno de desarrollo" class="md-nav__link">Habilitar el entorno de desarrollo</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_2" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_2" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#funcionalidades-del-sdk" title="Funcionalidades del SDK" class="md-nav__link">Funcionalidades del SDK</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#generacion-de-cip" title="Generación de CIP" class="md-nav__link">Generación de CIP</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_3" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_3" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#tratar-la-respuesta-del-servicio" title="Tratar la respuesta del servicio" class="md-nav__link">Tratar la respuesta del servicio</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#swift_4" title="Swift" class="md-nav__link">Swift</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#obtencion-de-datos" title="Obtención de datos" class="md-nav__link">Obtención de datos</a></li><li class="md-nav__item"><a href="#abrir-pasarella-en-una-webview" title="Abrir pasarella en una WebView" class="md-nav__link">Abrir pasarella en una WebView</a></li></ul></nav></li></ul></nav></li><li class="md-nav__item"><a href="#consultar-cips" title="Consultar CIP(s)" class="md-nav__link">Consultar CIP(s)</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#objective-c_4" title="Objective-C" class="md-nav__link">Objective-C</a></li><li class="md-nav__item"><a href="#swift_5" title="Swift" class="md-nav__link">Swift</a></li></ul></nav></li><li class="md-nav__item"><a href="#feedback" title="Feedback" class="md-nav__link">Feedback</a></li></ul></nav></li></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><h1>Home</h1><h2 id="pagoefectivo-sdk-para-ios"><strong>PagoEfectivo SDK para iOS</strong></h2>
<hr />
<p><img alt="PagoEfectivoSDK para iOS" src="assets/logo.png" /></p>
<h3 id="overview"><strong>Overview</strong></h3>
<hr />
<p><strong>PagoEfectivoSDK</strong> le permitirá implementar de forma rápida y sencilla las funcionalidades que ofrece para realizar transacciones online a través de la plataforma de PagoEfectivo para iOS.</p>
<p>En el siguiente manual encontrará todo lo necesario para poder realizar la implementación del SDK, así como la forma correcta de implementar sus principales funciones tales como <strong>Generar un CIP</strong> y <strong>Listar CIPs</strong>.</p>
<h3 id="pre-requisitos"><strong>Pre requisitos</strong></h3>
<hr />
<ul>
<li><a href="https://developer.apple.com/xcode/">Xcode 9+</a></li>
<li>iOS 11+</li>
</ul>
<h3 id="instalacion"><strong>Instalación</strong></h3>
<hr />
<p>Es recomendable usar <strong>CocoaPods</strong> para instalar el SDK:</p>
<h4 id="via-cocoapods"><strong>Vía CocoaPods</strong></h4>
<p>Es necesario tener instalado el gestor de paquetería, para ello debes ir a  <a href="https://cocoapods.org/">la página web de cocoapods</a>, instalar CocoaPods y luego puedes continuar con los siguientes pasos.</p>
<p><strong>Paso 1:</strong>
Vía terminal, ubicarse en la carpeta del proyecto, donde se encuentra el archivo de extensión <strong>.xcodeproj</strong></p>
<p><strong>Paso 2:</strong>
Una vez ubicado en la carpeta del proyecto, ejecutar el siguiente comando:</p>
<div class="codehilite"><pre><span></span>$ pod init
</pre></div>


<p><strong>Paso 3:</strong>
Agrega la siguiente línea de código al archivo <strong>Podfile</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">pod</span> <span class="s2">&quot;PagoEfectivoSDK&quot;</span>
</pre></div>
</td></tr></table>

<p><strong>Paso 5:</strong>
Instala el pod y abre el archivo de extensión <strong>.xcworkspace</strong>:</p>
<div class="codehilite"><pre><span></span>$ pod install
$ open yourProject.xcworkspace
</pre></div>


<h4 id="via-manual"><strong>Vía manual</strong></h4>
<p><strong>Paso 1:</strong>
Descargar el archivo <a href="https://github.com/PagoEfectivo/sdk-pe-ios/releases/download/1.0.5/PagoEfectivoSDK.framework.zip"><strong>PagoEfectivoSDK.framework</strong></a></p>
<p><strong>Paso 2:</strong>
Abrir tu proyecto con Xcode y agregar el archivo a las secciones <strong>Embedded Binaries</strong> en el target principal de tu proyecto</p>
<p>Aquí te dejamos un ejemplo de cómo debe agregarse de forma manual:
<img alt="ejemplo forma manual" src="assets/forma-manual.gif" /></p>
<h3 id="configuracion"><strong>Configuración</strong></h3>
<hr />
<p>Para poder hacer uso del SDK es necesario configurar nuestro proyecto según el lenguaje.
A continuación te mostramos como hacerlo con Objective-C o Swift:</p>
<h4 id="objective-c">Objective-C</h4>
<p>Para hacer uso de los métodos del SDK de PagoEfectivo bajo un proyecto en <strong>Objective-C</strong>, 
debes importar el módulo de PagoEfectivoSDK en el archivo <strong>AppDelegate.m</strong> del proyecto:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#import &lt;PagoEfectivoSDK/PagoEfectivoSDK.h&gt;</span>
</pre></div>
</td></tr></table>

<h4 id="swift">Swift</h4>
<p>Crear el archivo <strong><em>MyProject</em>-Brigding-Header.h</strong>, y establecer la ruta de este archivo en la directiva <strong>Objective-C Bridging Header</strong> que se encuentra en la sección <strong>Build Settings</strong> en el <em>target</em> principal del proyecto.</p>
<p><strong>Paso 1:</strong>
En el archivo <strong><em>MyProject</em>-Brigding-Header.h</strong> agregar lo siguiente:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#import &lt;PagoEfectivoSDK/PagoEfectivoSDK.h&gt;</span>
</pre></div>
</td></tr></table>

<p><strong>Paso 2:</strong>
En el archivo <strong>AppDelegate.swift</strong> agregar lo siguiente:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">import</span> <span class="nc">PagoEfectivoSDK</span>
</pre></div>
</td></tr></table>

<h3 id="inicializacion"><strong>Inicialización</strong></h3>
<hr />
<p>Para poder hacer uso de las funciones que ofrece el SDK, es necesario inicializar la librería. 
Para ello debes tener estos valores previamente:</p>
<ul>
<li>Service Id</li>
<li>Access Key</li>
<li>Secret Key</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Si aún no tienes los valores correspondientes favor de comunicarte <a href="mailto:feedback@pagoefectivo.pe">aquí</a>.</p>
</div>
<h4 id="objective-c_1">Objective-C</h4>
<p>Se debe agregar el siguiente código  en el método <strong>application</strong> que se encuentra en el archivo <strong>AppDelegate.m</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="n">PagoEfectivoSDK</span> <span class="nl">config</span><span class="p">:</span> <span class="s">@&quot;MY_SECRET_KEY&quot;</span>
                  <span class="nl">accessKey</span><span class="p">:</span> <span class="s">@&quot;MY_ACCESS_KEY&quot;</span>
                  <span class="nl">serviceId</span><span class="p">:</span> <span class="n">MY_SERVICE_ID</span><span class="p">];</span>
</pre></div>
</td></tr></table>

<h4 id="swift_1">Swift</h4>
<p>Se debe agregar el siguiente código en el método <strong>application</strong> que se encuentra en el archivo <strong>AppDelegate.swift</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">PagoEfectivoSDK</span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">&quot;MY_SECRET_KEY&quot;</span><span class="p">,</span> 
    <span class="n">accessKey</span><span class="p">:</span> <span class="s">&quot;MY_ACCESS_KEY&quot;</span><span class="p">,</span> 
    <span class="n">serviceId</span><span class="p">:</span> <span class="n">MY_SERVICE_ID</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h3 id="habilitar-el-entorno-de-desarrollo"><strong>Habilitar el entorno de desarrollo</strong></h3>
<hr />
<p>Para poder hacer uso de las funciones que ofrece el SDK en el entorno de desarrollo, es necesario agregar el parámetro <strong>sandbox</strong>:</p>
<h4 id="objective-c_2">Objective-C</h4>
<p>Se debe agregar el siguiente código  en el método <strong>application</strong> que se encuentra en el archivo <strong>AppDelegate.m</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="n">PagoEfectivoSDK</span> <span class="nl">config</span><span class="p">:</span> <span class="s">@&quot;MY_SECRET_KEY&quot;</span>
                  <span class="nl">accessKey</span><span class="p">:</span> <span class="s">@&quot;MY_ACCESS_KEY&quot;</span>
                  <span class="nl">serviceId</span><span class="p">:</span> <span class="n">MY_SERVICE_ID</span>
                  <span class="nl">sandbox</span><span class="p">:</span> <span class="nb">true</span><span class="p">];</span>
</pre></div>
</td></tr></table>

<h4 id="swift_2">Swift</h4>
<p>Se debe agregar el siguiente código en el método <strong>application</strong> que se encuentra en el archivo <strong>AppDelegate.swift</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">PagoEfectivoSDK</span><span class="p">.</span><span class="n">config</span><span class="p">(</span><span class="s">&quot;MY_SECRET_KEY&quot;</span><span class="p">,</span> 
    <span class="n">accessKey</span><span class="p">:</span> <span class="s">&quot;MY_ACCESS_KEY&quot;</span><span class="p">,</span> 
    <span class="n">serviceId</span><span class="p">:</span> <span class="n">MY_SERVICE_ID</span><span class="p">,</span>
    <span class="n">sandbox</span><span class="p">:</span> <span class="kc">true</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<h2 id="funcionalidades-del-sdk"><strong>Funcionalidades del SDK</strong></h2>
<hr />
<p>El SDK provee las siguientes funcionalidades:</p>
<h3 id="generacion-de-cip"><strong>Generación de CIP</strong></h3>
<hr />
<h4 id="objective-c_3">Objective-C</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//Creamos una nueva instancia de tipo CipRequest</span>
<span class="n">CipRequest</span> <span class="o">*</span><span class="n">request</span> <span class="o">=</span> <span class="p">[</span><span class="n">CipRequest</span> <span class="n">alloc</span><span class="p">];</span>

<span class="c1">//Se establecen las propiedades  requeridas</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setAmount</span><span class="p">:</span><span class="mf">100.05</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setCurrency</span><span class="p">:</span> <span class="n">USD</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setTransactionCode</span><span class="p">:</span><span class="s">@&quot;101&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserEmail</span><span class="p">:</span><span class="s">@&quot;jhon@doe.com&quot;</span><span class="p">];</span>

<span class="c1">//Opcionales</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setAdminEmail</span><span class="p">:</span><span class="s">@&quot;foo@bar.com&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setDateExpiry</span><span class="p">:</span><span class="s">@&quot;2000-01-31T05:40:00-05:00&quot;</span><span class="p">];</span> <span class="c1">//Debe ingresarse en formato UTC</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setPaymentConcept</span><span class="p">:</span><span class="s">@&quot;Pago en tienda&quot;</span><span class="p">];</span> <span class="c1">//El concepto de pago</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setAdditionalData</span><span class="p">:</span><span class="s">@&quot;Se realizó un pago ... &quot;</span><span class="p">];</span> <span class="c1">//Data adicional</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserName</span><span class="p">:</span><span class="s">@&quot;jhon&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserLastName</span><span class="p">:</span><span class="s">@&quot;doe&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserUbigeo</span><span class="p">:</span><span class="s">@&quot;010101&quot;</span><span class="p">];</span> <span class="c1">//Formato</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserCountry</span><span class="p">:</span><span class="s">@&quot;PERU&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserDocumentType</span><span class="p">:</span> <span class="p">.</span><span class="n">DNI</span><span class="p">];</span> <span class="c1">//El SDK provee una colección de tipos de documentType</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserDocumentNumber</span><span class="p">:</span><span class="s">@&quot;00000000&quot;</span><span class="p">];</span> <span class="c1">//Por ejemplo el formato de DNI</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserPhone</span><span class="p">:</span><span class="s">@&quot;999999999&quot;</span><span class="p">];</span>
<span class="p">[</span><span class="n">request</span> <span class="nl">setUserCodeCountry</span><span class="p">:</span><span class="s">@&quot;+51&quot;</span><span class="p">];</span>

<span class="c1">//Creamos una variable que almacene nuestra función que irá de callback para el servicio</span>
<span class="n">serviceCallback</span> <span class="k">__block</span> <span class="n">callbackResponse</span> <span class="o">=</span> <span class="o">^</span><span class="p">(</span><span class="kt">long</span> <span class="n">status</span><span class="p">,</span> <span class="kt">id</span> <span class="n">receivedData</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">){</span>
        <span class="c1">//Código para tratar con la respuesta</span>
<span class="p">};</span>

<span class="c1">//Usamos la función de generación de CIP del SDK</span>
<span class="p">[[</span><span class="n">PagoEfectivoSDK</span> <span class="n">Cip</span><span class="p">]</span> <span class="nl">generate</span><span class="p">:</span><span class="n">EN</span> 
                  <span class="nl">requestObject</span><span class="p">:</span><span class="n">instanceRequest</span> 
                <span class="nl">responseHandler</span><span class="p">:</span><span class="n">callbackResponse</span><span class="p">];</span>
</pre></div>
</td></tr></table>

<h4 id="swift_3">Swift</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//creamos una nueva instancia de tipo CipRequest</span>
<span class="kd">let</span> <span class="nv">request</span> <span class="p">=</span> <span class="n">CipRequest</span><span class="p">()</span>
<span class="n">request</span><span class="p">.</span><span class="n">amount</span> <span class="p">=</span> <span class="mf">100.05</span>
<span class="n">request</span><span class="p">.</span><span class="n">currency</span> <span class="p">=</span> <span class="p">.</span><span class="n">PEN</span>
<span class="n">request</span><span class="p">.</span><span class="n">transactionCode</span> <span class="p">=</span> <span class="s">&quot;101&quot;</span>
<span class="n">request</span><span class="p">.</span><span class="n">userEmail</span> <span class="p">=</span> <span class="s">&quot;jhon@doe.com&quot;</span>

<span class="c1">//Opcionales</span>
<span class="n">request</span><span class="p">.</span><span class="n">adminEmail</span> <span class="p">=</span> <span class="s">&quot;foo@bar.com&quot;</span>
<span class="n">request</span><span class="p">.</span><span class="n">dateExpiry</span> <span class="p">=</span> <span class="s">&quot;2000-01-31T05:40:00-05:00&quot;</span> <span class="c1">//Debe ingresarse en formato UTC</span>
<span class="n">request</span><span class="p">.</span><span class="n">paymentConcept</span> <span class="p">=</span> <span class="s">&quot;Pago en tienda&quot;</span> <span class="c1">//El concepto de pago</span>
<span class="n">request</span><span class="p">.</span><span class="n">additionalData</span> <span class="p">=</span> <span class="s">&quot;Se realizó un pago ... &quot;</span> <span class="c1">//Data adicional</span>
<span class="n">request</span><span class="p">.</span><span class="n">userName</span> <span class="p">=</span> <span class="s">&quot;jhon&quot;</span>
<span class="n">request</span><span class="p">.</span><span class="n">userLastName</span> <span class="p">=</span> <span class="s">&quot;doe&quot;</span>
<span class="n">request</span><span class="p">.</span><span class="n">userUbigeo</span> <span class="p">=</span> <span class="s">&quot;010101&quot;</span> <span class="c1">//Formato</span>
<span class="n">request</span><span class="p">.</span><span class="n">userCountry</span> <span class="p">=</span> <span class="s">&quot;PERU&quot;</span>
<span class="n">request</span><span class="p">.</span><span class="n">userDocumentType</span> <span class="p">=</span> <span class="p">.</span><span class="n">DNI</span> <span class="c1">//El SDK provee una colección de tipos de documentType</span>
<span class="n">request</span><span class="p">.</span><span class="n">userDocumentNumber</span> <span class="p">=</span> <span class="s">&quot;00000000&quot;</span> <span class="c1">//Por ejemplo el formato de DNI</span>
<span class="n">request</span><span class="p">.</span><span class="n">userPhone</span> <span class="p">=</span> <span class="s">&quot;999999999&quot;</span>
<span class="n">request</span><span class="p">.</span><span class="n">userCodeCountry</span> <span class="p">=</span> <span class="s">&quot;+51&quot;</span>

<span class="c1">// Usamos la función de generación de CIP del SDK</span>
<span class="n">PagoEfectivoSDK</span><span class="p">.</span><span class="n">cip</span><span class="p">().</span><span class="n">generate</span><span class="p">(.</span><span class="n">EN</span><span class="p">,</span> 
    <span class="n">requestObject</span><span class="p">:</span> <span class="n">request</span><span class="p">,</span>
    <span class="n">responseHandler</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
        <span class="c1">//Código para tratar con la respuesta del servicio</span>
<span class="p">})</span>
</pre></div>
</td></tr></table>

<h3 id="tratar-la-respuesta-del-servicio"><strong>Tratar la respuesta del servicio</strong></h3>
<hr />
<h4 id="swift_4">Swift</h4>
<h5 id="obtencion-de-datos">Obtención de datos</h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>            <span class="k">if</span><span class="p">(</span><span class="n">error</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">){</span>
                <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">async</span><span class="p">{</span>
                    <span class="c1">//Mostramos el error Vía alerta o una vista personalizada. Ejm:</span>
                    <span class="kc">self</span><span class="p">.</span><span class="n">present</span><span class="p">(</span><span class="n">Help</span><span class="p">.</span><span class="n">customAlert</span><span class="p">(</span><span class="n">arrayErrorsForUser</span><span class="p">:</span> <span class="n">Help</span><span class="p">.</span><span class="n">returnErrorFounded</span><span class="p">(</span><span class="n">error</span><span class="p">:</span> <span class="n">error</span><span class="p">!),</span> <span class="n">time</span><span class="p">:</span> <span class="mi">2</span><span class="p">),</span> <span class="n">animated</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span> <span class="n">completion</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span>
                    <span class="n">refresh</span><span class="p">.</span><span class="n">stopAnimating</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// Convertimos la respuesta en diccionario</span>
                <span class="k">guard</span> <span class="kd">let</span> <span class="nv">dictionary</span> <span class="p">=</span> <span class="n">result</span> <span class="k">as</span><span class="p">?</span> <span class="p">[</span><span class="nb">String</span><span class="p">:</span> <span class="nb">Any</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="k">guard</span> <span class="kd">let</span> <span class="nv">data</span> <span class="p">=</span> <span class="n">dictionary</span><span class="p">[</span><span class="s">&quot;data&quot;</span><span class="p">]</span> <span class="k">as</span><span class="p">?</span> <span class="p">[</span><span class="nb">String</span><span class="p">:</span> <span class="nb">Any</span><span class="p">]</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
                <span class="c1">// Obtenemos los datos necesarios para nuestra siguiente vista</span>
                <span class="kc">self</span><span class="p">.</span><span class="n">dataCip</span><span class="p">.</span><span class="n">numberCip</span>          <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;cip&quot;</span><span class="p">]</span>               <span class="k">as</span><span class="p">!</span> <span class="nb">Int</span>         <span class="c1">// Campo: Número de cip</span>
                <span class="kc">self</span><span class="p">.</span><span class="n">dataCip</span><span class="p">.</span><span class="n">currencyCip</span>        <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;currency&quot;</span><span class="p">]</span>          <span class="k">as</span><span class="p">!</span> <span class="nb">String</span>      <span class="c1">// Campo: Tipo de moneda</span>
                <span class="kc">self</span><span class="p">.</span><span class="n">dataCip</span><span class="p">.</span><span class="n">transationCodeCip</span>  <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;transactionCode&quot;</span><span class="p">]</span>   <span class="k">as</span><span class="p">!</span> <span class="nb">String</span>      <span class="c1">// Campo: Código de transacción</span>
                <span class="kc">self</span><span class="p">.</span><span class="n">dataCip</span><span class="p">.</span><span class="n">amountCip</span>          <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;amount&quot;</span><span class="p">]</span>            <span class="k">as</span><span class="p">!</span> <span class="nb">Double</span>      <span class="c1">// Campo: Monto</span>
                <span class="kc">self</span><span class="p">.</span><span class="n">dataCip</span><span class="p">.</span><span class="n">dateExpiryCip</span>      <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;dateExpiry&quot;</span><span class="p">]</span>        <span class="k">as</span><span class="p">!</span> <span class="nb">String</span>      <span class="c1">// Campo: Fecha de vencimiento</span>
                <span class="kc">self</span><span class="p">.</span><span class="n">dataCip</span><span class="p">.</span><span class="n">cipUrl</span>             <span class="p">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&quot;cipUrl&quot;</span><span class="p">]</span>            <span class="k">as</span><span class="p">!</span> <span class="nb">String</span>      <span class="c1">// Campo: Url de pasarela de pago</span>
                <span class="n">DispatchQueue</span><span class="p">.</span><span class="n">main</span><span class="p">.</span><span class="n">async</span><span class="p">{</span>
                    <span class="kc">self</span><span class="p">.</span><span class="n">performSegue</span><span class="p">(</span><span class="n">withIdentifier</span><span class="p">:</span> <span class="n">Global</span><span class="p">.</span><span class="n">Segue</span><span class="p">.</span><span class="n">showPasarela</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="kc">self</span><span class="p">)</span>
                    <span class="n">refresh</span><span class="p">.</span><span class="n">stopAnimating</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}</span>
</pre></div>
</td></tr></table>

<h5 id="abrir-pasarella-en-una-webview">Abrir pasarella en una WebView</h5>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>            <span class="kr">override</span> <span class="kd">func</span> <span class="nf">tableView</span><span class="p">(</span><span class="kc">_</span> <span class="n">tableView</span><span class="p">:</span> <span class="bp">UITableView</span><span class="p">,</span> <span class="n">didSelectRowAt</span> <span class="n">indexPath</span><span class="p">:</span> <span class="n">IndexPath</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">indexPath</span><span class="p">.</span><span class="n">row</span> <span class="p">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="kd">let</span> <span class="nv">webView</span> <span class="p">=</span> <span class="bp">WKWebView</span><span class="p">(</span><span class="n">frame</span><span class="p">:</span> <span class="bp">CGRect</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">frame</span><span class="p">.</span><span class="n">size</span><span class="p">.</span><span class="n">height</span><span class="p">))</span>
                    <span class="kc">self</span><span class="p">.</span><span class="n">view</span><span class="p">.</span><span class="n">addSubview</span><span class="p">(</span><span class="n">webView</span><span class="p">)</span>
                    <span class="kd">let</span> <span class="nv">url</span> <span class="p">=</span> <span class="n">URL</span><span class="p">(</span><span class="n">string</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">urlCip</span><span class="p">.</span><span class="n">text</span><span class="p">!)</span>  <span class="c1">// Url obtenida de la respuesta del cip (data[&quot;cipUrl&quot;])</span>
                    <span class="n">webView</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">URLRequest</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="n">url</span><span class="p">!))</span>
                    <span class="k">return</span>
                <span class="p">}</span>
            <span class="p">}</span>
</pre></div>
</td></tr></table>

<h3 id="consultar-cips"><strong>Consultar CIP(s)</strong></h3>
<hr />
<h4 id="objective-c_4">Objective-C</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//Definimos un arreglo</span>
<span class="bp">NSArray</span> <span class="o">*</span><span class="n">cips</span> <span class="o">=</span> <span class="l">@[</span><span class="s">@&quot;2495383&quot;</span><span class="p">,</span><span class="s">@&quot;50&quot;</span><span class="p">,</span><span class="s">@&quot;10&quot;</span><span class="l">]</span><span class="p">;</span>

<span class="c1">//Usamos la función de búsqueda de CIPs del SDK</span>
<span class="p">[[</span><span class="n">PagoEfectivoSDK</span> <span class="n">Cip</span><span class="p">]</span> <span class="nl">search</span><span class="p">:</span><span class="n">cips</span> 
              <span class="nl">responseHandler</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">long</span> <span class="n">status</span><span class="p">,</span> <span class="bp">NSMutableArray</span> <span class="o">*</span><span class="n">cipSearchArray</span><span class="p">,</span> <span class="bp">NSError</span> <span class="o">*</span><span class="n">error</span><span class="p">)</span> <span class="p">{</span>
     <span class="c1">//Código para tratar con la respuesta del servicio</span>
<span class="p">}];</span>
</pre></div>
</td></tr></table>

<h4 id="swift_5">Swift</h4>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//Definimos un arreglo</span>
<span class="kd">let</span> <span class="nv">cips</span><span class="p">:[</span><span class="nb">String</span><span class="p">]</span> <span class="p">=</span> <span class="p">[</span><span class="s">&quot;2495383&quot;</span><span class="p">,</span> <span class="s">&quot;50&quot;</span><span class="p">,</span> <span class="s">&quot;10&quot;</span><span class="p">];</span>

<span class="c1">//Usamos la función de búsqueda de CIPs del SDK</span>
<span class="n">PagoEfectivoSDK</span><span class="p">.</span><span class="n">cip</span><span class="p">().</span><span class="n">search</span><span class="p">(</span><span class="n">cips</span><span class="p">,</span> 
    <span class="n">responseHandler</span><span class="p">:</span> <span class="p">{</span> <span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="n">resul</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="k">in</span>
        <span class="c1">//Código para tratar con la respuesta del servicio</span>
<span class="p">})</span>
</pre></div>
</td></tr></table>

<div class="admonition info">
<p class="admonition-title">Info</p>
<p><a href="https://pagoefectivo.github.io/sdk-pe-ios-code-documentation/">La documentación de código</a> esta disponible para revisar a más detalle las funciones presentadas en esta documentación.</p>
</div>
<h3 id="feedback"><strong>Feedback</strong></h3>
<hr />
<p>En caso existan dudas, consultas o mejoras en la guía, favor de escribir al <a href="mailto:feedback@pagoefectivo.pe">correo de feedback</a>
con el asunto <strong>Documentación PagoEfectivoSDK.</strong></p></article></div></div></main><footer class="md-footer"><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright">powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div></div></div></footer></div><script src="assets/javascripts/application.b260a35d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"."}})</script></body></html>